{"version":3,"sources":["webpack:///./src/assets/fft.js","webpack:///./src/assets/complex-buffer.js","webpack:///src/components/Fft.vue","webpack:///./src/components/Fft.vue?c2d1","webpack:///./src/components/Fft.vue"],"names":["rearrangeSamples","samples","offset","w","stride","channels","target","pos","k","a","b","tmp","mask","shiftSamples","base","mid","i","inverseFft","real","imag","h","dx","dy","performFft","fft_fft","inverse","pi","Math","PI","j","angularScale","step","delta","sine","sin","fac_r","fac_i","mul_r","mul_i","group","pair","match","p_index","m_index","r","prod_r","prod_i","inc_i","complex_buffer_ComplexBuffer","ComplexBuffer","width","height","buffer","classCallCheck_default","this","Array","image_buffer","length","gamma","uint8","size","p","index","v","pow","complexBuffer","clone","sqrt","atan2","min","max","arguments","undefined","image","createFromImage","createFromImageBuffer","__webpack_exports__","Fft","name","data","mounted","methods","selectImage","event","start","img","magCanvas","document","getElementsByClassName","phaseCanvas","outputCanvas","fftData","complex_buffer","fft","mag","toMaginitude","autoContrast","toBuffer","phase","toPhase","output","ifft","toCanvas","components_Fft","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","src","on","click","_m","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext"],"mappings":"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","file":"static/js/10.38070e2d1ae2745c6a2c.js","sourcesContent":["/* eslint-disable */\r\n\r\nfunction rearrangeSamples(samples, offset, w, stride, channels) {\r\n  var target = 0;\r\n  for (var pos = 0; pos < w; ++pos) {\r\n    if (target > pos) {\r\n      for (var k = 0; k < channels; ++k) {\r\n        var a = offset + target * stride + k;\r\n        var b = offset + pos * stride + k;\r\n        var tmp = samples[a];\r\n        samples[a] = samples[b];\r\n        samples[b] = tmp;\r\n      }\r\n    }\r\n    var mask = w;\r\n    while ((target & (mask >>= 1))) {\r\n      target &= ~mask;\r\n    }\r\n    target |= mask;\r\n  }\r\n}\r\n\r\nfunction shiftSamples(samples, base, w, stride, channels) {\r\n  var mid = base + w * stride / 2;\r\n  for (var i = 0; i < w / 2; ++i) {\r\n    for (var k = 0; k < channels; ++k) {\r\n      var a = base + i * stride + k;\r\n      var b = mid + i * stride + k;\r\n      var tmp = samples[a];\r\n      samples[a] = samples[b];\r\n      samples[b] = tmp;\r\n    }\r\n  }\r\n}\r\n\r\nfunction inverseFft(real, imag, w, h, dx, dy, channels) {\r\n  return performFft(real, imag, w, h, dx, dy, true, channels);\r\n}\r\n\r\nfunction fft(real, imag, w, h, dx, dy, channels) {\r\n  return performFft(real, imag, w, h, dx, dy, false, channels);\r\n}\r\n\r\nfunction performFft(real, imag, w, h, dx, dy, inverse, channels) {\r\n  const pi = Math.PI;\r\n  for (var j = 0; j < h; ++j) {\r\n    if (inverse) {\r\n      shiftSamples(real, j * dy, w, dx, channels);\r\n      shiftSamples(imag, j * dy, w, dx, channels);\r\n    }\r\n\r\n    rearrangeSamples(real, j * dy, w, dx, channels);\r\n    rearrangeSamples(imag, j * dy, w, dx, channels);\r\n\r\n    var angularScale = inverse ? pi : -pi;\r\n    for (var step = 1; step < w; step += step ) {\r\n      var delta = angularScale / step;\r\n      var sine = Math.sin(delta / 2);\r\n      var fac_r = 1;\r\n      var fac_i = 0;\r\n      var mul_r = -2 * sine * sine;\r\n      var mul_i = Math.sin( delta );\r\n      for (var group = 0; group < step; ++group) {\r\n        for (var pair = group; pair < w; pair += step * 2) {\r\n          var match = pair + step;\r\n          for (var k = 0; k < channels; ++k) {\r\n            var p_index = j * dy + pair * dx + k;\r\n            var m_index = j * dy + match * dx + k;\r\n            var r = real[m_index];\r\n            var i = imag[m_index];\r\n\r\n            var prod_r = r * fac_r - i * fac_i;\r\n            var prod_i = r * fac_i + i * fac_r;\r\n\r\n            real[m_index] = real[p_index] - prod_r;\r\n            imag[m_index] = imag[p_index] - prod_i;\r\n            real[p_index] += prod_r;\r\n            imag[p_index] += prod_i;\r\n          }\r\n        }\r\n\r\n        var inc_r = mul_r * fac_r - mul_i * fac_i;\r\n        var inc_i = mul_r * fac_i + mul_i * fac_r;\r\n        fac_r += inc_r;\r\n        fac_i += inc_i;\r\n      }\r\n    }\r\n\r\n    if (!inverse) {\r\n      shiftSamples(real, j * dy, w, dx, channels);\r\n      shiftSamples(imag, j * dy, w, dx, channels);\r\n    }\r\n  }\r\n}\r\n\r\nexport { fft, inverseFft };\n\n\n// WEBPACK FOOTER //\n// ./src/assets/fft.js","/* eslint-disable */\r\n\r\nimport ImageBuffer from './image-buffer';\r\nimport { fft, inverseFft } from './fft';\r\n\r\nclass ComplexBuffer {\r\n  constructor(channels, real, imag, width, height, buffer) {\r\n    this.channels = channels;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.real = real || new Array(width * height * 4);\r\n    this.imag = imag || new Array(width * height * 4);\r\n    this.buffer = buffer || new ImageBuffer(this.width, this.height);\r\n  }\r\n\r\n  static createFromImageBuffer(buffer, channels = 3) {\r\n    const size = buffer.width * buffer.height;\r\n    const real = new Array(buffer.width * buffer.height * 4);\r\n    const imag = new Array(buffer.width * buffer.height * 4);\r\n\r\n    const uint8 = buffer.uint8;\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < channels; ++k) {\r\n        const index = p * 4 + k;\r\n        real[index] = uint8[index] / 255;\r\n        imag[index] = 0;\r\n      }\r\n    }\r\n    \r\n    return new ComplexBuffer(channels, real, imag, buffer.width, buffer.height, buffer);\r\n  }\r\n\r\n  static createFromImage(image, channels = 3) {\r\n    const buffer = ImageBuffer.createFromImage(image);\r\n    return ComplexBuffer.createFromImageBuffer(buffer, channels);\r\n  }\r\n\r\n  clone() {\r\n    const real = new Array(this.real.length);\r\n    for (let i = 0; i < this.real.length; i++) {\r\n      real[i] = this.real[i];\r\n    }\r\n    const imag = new Array(this.imag.length);\r\n    for (let i = 0; i < this.imag.length; i++) {\r\n      imag[i] = this.imag[i];\r\n    }\r\n    return new ComplexBuffer(this.channels, real, imag, this.width, this.height);\r\n  }\r\n\r\n  toBuffer(gamma) {\r\n    const buffer = new ImageBuffer(this.width, this.height);\r\n    \r\n    const real = this.real;\r\n    const uint8 = buffer.uint8;\r\n    const size = this.width * this.height;\r\n\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        let v = real[index];\r\n        v = v < 0 ? 0 : v > 1 ? 1 : v;\r\n        if (gamma) v = Math.pow(v, 1 / gamma);\r\n        uint8[index] = 255 * v;\r\n      }\r\n      uint8[p * 4 + 3] = 255;\r\n    }\r\n\r\n    return buffer;\r\n  }\r\n\r\n  // magnitude = sqrt(real^2+imaginary^2)\r\n  toMaginitude() {\r\n    const complexBuffer = this.clone();\r\n    const real = complexBuffer.real;\r\n    const imag = complexBuffer.imag;\r\n    const size = complexBuffer.width * complexBuffer.height;\r\n\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        const r = real[index];\r\n        const i = imag[index];\r\n        real[index] = Math.sqrt(r * r + i * i) / size;\r\n        imag[index] = 0;\r\n      }\r\n    }\r\n\r\n    return complexBuffer;\r\n  }\r\n\r\n  // phase = atan2(imag,real)\r\n  toPhase() {\r\n    const complexBuffer = this.clone();\r\n    const real = complexBuffer.real;\r\n    const imag = complexBuffer.imag;\r\n    const size = complexBuffer.width * complexBuffer.height;\r\n    const pi = Math.PI;\r\n\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        const r = real[index];\r\n        const i = imag[index];\r\n        real[index] = Math.atan2(i, r) / pi / 2 + 0.5; // atan2 then scale -pi...+pi to 0...1;\r\n        imag[index] = 0;\r\n      }\r\n    }\r\n\r\n    return complexBuffer;\r\n  }\r\n\r\n  ifft() {\r\n    const complexBuffer = this.clone();\r\n    const w = complexBuffer.width;\r\n    const h = complexBuffer.height;\r\n    const real = complexBuffer.real;\r\n    const imag = complexBuffer.imag;\r\n\r\n    inverseFft(real, imag, w, h, 4, w * 4, this.channels);\r\n    inverseFft(real, imag, h, w, w * 4, 4, this.channels);\r\n\r\n    // inverseFft on ComplexBuffer data scales the data by (w * h), i'm not sure why. Scaling back here makes the data work better in more places.\r\n    const size = w * h;\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        real[index] = real[index] / size;\r\n        imag[index] = 0;\r\n      }\r\n    }\r\n\r\n    return complexBuffer;\r\n  }\r\n\r\n  fft() {\r\n    const complexBuffer = this.clone();\r\n    const w = complexBuffer.width;\r\n    const h = complexBuffer.height;\r\n    const real = complexBuffer.real;\r\n    const imag = complexBuffer.imag;\r\n\r\n    fft(real, imag, w, h, 4, w * 4, this.channels);\r\n    fft(real, imag, h, w, w * 4, 4, this.channels);\r\n\r\n    return complexBuffer;\r\n  }\r\n\r\n  autoContrast() {\r\n    const complexBuffer = this.clone();\r\n    const real = complexBuffer.real;\r\n    const w = complexBuffer.width;\r\n    const h = complexBuffer.height;\r\n    const size = w * h;\r\n    const min = [1, 1, 1, 1], max = [0, 0, 0, 0];\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        const r = real[index];\r\n        min[k] = Math.min(r, min[k]);\r\n        max[k] = Math.max(r, max[k]);\r\n      }\r\n    }\r\n\r\n    for (let p = 0; p < size; ++p) {\r\n      for (let k = 0; k < this.channels; ++k) {\r\n        const index = p * 4 + k;\r\n        real[index] = (real[index] - min[k]) / (max[k] - min[k]);\r\n      }\r\n    }\r\n\r\n    return complexBuffer;\r\n  }\r\n}\r\n\r\nexport default ComplexBuffer;\n\n\n// WEBPACK FOOTER //\n// ./src/assets/complex-buffer.js","<template>\n  <section class=\"section-fft\">\n    <h1>FFT</h1>\n    <p>Experiments with Fast Fourier Transformations in javascript. Click an image at the top to show an FFT magnitude and phase image.</p>\n\n    <img\n      src=\"/static/sample-images/lena.png\"\n      @click=\"selectImage\">\n    <img\n      src=\"/static/sample-images/clown.jpg\"\n      @click=\"selectImage\" >\n    <img\n      src=\"/static/sample-images/sine4.png\"\n      @click=\"selectImage\" >\n    <img\n      src=\"/static/sample-images/twigs.jpg\"\n      @click=\"selectImage\">\n    <div>\n      <div>\n        Magnitude<br >\n        <canvas\n          class=\"mag-canvas\"\n          width=\"100\"\n          height=\"100\" />\n      </div>\n\n      <div>\n        Phase<br >\n        <canvas\n          class=\"phase-canvas\"\n          width=\"100\"\n          height=\"100\" />\n      </div>\n      <div>\n        Inverse FFT<br >\n        <canvas\n          class=\"output-canvas\"\n          width=\"100\"\n          height=\"100\" />\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\n/* eslint-disable */\n\nimport ComplexBuffer from \"../assets/complex-buffer\";\nimport CanvasWriter from \"../assets/canvas-writer\";\n\nexport default {\n  name: \"Fft\",\n  data() {\n    return {};\n  },\n  mounted() {},\n  methods: {\n    selectImage(event) {\n      this.start(event.target);\n    },\n    start(img) {\n      const magCanvas = document.getElementsByClassName(\"mag-canvas\")[0];\n      const phaseCanvas = document.getElementsByClassName(\"phase-canvas\")[0];\n      const outputCanvas = document.getElementsByClassName(\"output-canvas\")[0];\n\n      const complexBuffer = ComplexBuffer.createFromImage(img);\n      const fftData = complexBuffer.fft();\n      const mag = fftData\n        .toMaginitude()\n        .autoContrast()\n        .toBuffer(6);\n      const phase = fftData.toPhase().toBuffer();\n      const output = fftData.ifft().toBuffer();\n\n      mag.toCanvas(magCanvas);\n      phase.toCanvas(phaseCanvas);\n      output.toCanvas(outputCanvas);\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.section-fft {\n  canvas {\n    border: 1px solid $site-gray;\n  }\n  img {\n    cursor: pointer;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Fft.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"section-fft\"},[_c('h1',[_vm._v(\"FFT\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Experiments with Fast Fourier Transformations in javascript. Click an image at the top to show an FFT magnitude and phase image.\")]),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/static/sample-images/lena.png\"},on:{\"click\":_vm.selectImage}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/static/sample-images/clown.jpg\"},on:{\"click\":_vm.selectImage}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/static/sample-images/sine4.png\"},on:{\"click\":_vm.selectImage}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/static/sample-images/twigs.jpg\"},on:{\"click\":_vm.selectImage}}),_vm._v(\" \"),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_vm._v(\"\\n      Magnitude\"),_c('br'),_vm._v(\" \"),_c('canvas',{staticClass:\"mag-canvas\",attrs:{\"width\":\"100\",\"height\":\"100\"}})]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n      Phase\"),_c('br'),_vm._v(\" \"),_c('canvas',{staticClass:\"phase-canvas\",attrs:{\"width\":\"100\",\"height\":\"100\"}})]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n      Inverse FFT\"),_c('br'),_vm._v(\" \"),_c('canvas',{staticClass:\"output-canvas\",attrs:{\"width\":\"100\",\"height\":\"100\"}})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-38a06b61\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Fft.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-38a06b61\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"includePaths\\\":[\\\"./src/styles\\\",\\\"./node_modules/bootstrap/scss\\\",\\\"./node_modules/bootstrap/dist/css\\\"],\\\"data\\\":\\\"@import \\\\\\\"_main.scss\\\\\\\";\\\",\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Fft.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Fft.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Fft.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-38a06b61\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Fft.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-38a06b61\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Fft.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}